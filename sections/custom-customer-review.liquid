{% schema %}
{
    "name": "Custom Customer Review",
    "settings": [
        { "type": "header", "content": "标题" },
        { "type": "liquid", "id": "title", "label": "标题" },

        { "type": "header", "content": "配置" },
        { "type": "text", "id": "custom_class", "label": "自定义class" },
        { "type": "checkbox", "id": "auto_loop", "label": "自动轮播", "default":false },
        { "type": "range", "id": "auto_loop_speed", "label": "自动轮播速度(秒)", "min": 1, "max": 10, "step": 1, "unit": "s", "default": 5 }
    ],
    "blocks": [
        {
            "type": "slide",
            "name": "Slide",
            "settings": [
                { "type": "image_picker", "id": "image", "label": "图片" },
                { "type": "liquid", "id": "content", "label": "内容" }
            ]
        }
    ],

    "presets": [
        {
        "name": "Custom Customer Review",
        "category": "custom"
        }
    ]
}
{% endschema %}


{{ 'custom-customer-review.css' | asset_url | stylesheet_tag }}

<div class="custom-customer-review" data-section-id="{{ section.id }}">
    <div class="review-inner safe-container">
        {% if section.settings.title != blank %}
            <div class="section-title"><h2>{{ section.settings.title }}</h2></div>
        {% endif %}
        <div class="review-swiper">
            <div class="swiper">
                <div class="swiper-wrapper">
                    {% for block in section.blocks %}
                        <div class="swiper-slide">
                            <div class="item">

                                <div class="content">
                                    {% if block.settings.content != blank %}
                                        <div class="slide-content">{{ block.settings.content }}</div>
                                    {% endif %}
                                </div>

                                {% if block.settings.image != blank %}
                                    <div class="image">
                                        <span class="short-line"></span>
                                        <img src="{{ block.settings.image | image_url: width: 767 }}" width="auto" height="auto" />
                                    </div>
                                {% endif %}
                            </div>
                            
                        </div>
                    {% endfor %}
                </div>
            </div>

            <div class="swiper-custom-navigation">
                <div class="custom-button-prev custom-button">
                    <svg width="50" height="50" style="transform:rotate(-180deg);" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect width="33.1429" height="27.7143" transform="matrix(-4.37114e-08 -1 -1 4.37114e-08 38.7145 40.7143)" fill="#FFFEFB"/>
                        <path d="M25.0614 24.9387L24.9387 25.0615C24.9777 25.0168 25.0168 24.9777 25.0614 24.9387Z" fill="white"/>
                        <path class="bg" d="M25.0001 50.0001C11.1942 50.0001 4.41472e-05 38.8059 4.41472e-05 25.0001C4.41472e-05 11.1942 11.1942 3.05176e-05 25.0001 3.05176e-05C38.8059 3.05176e-05 50.0001 11.1942 50.0001 25.0001C50.0001 38.8059 38.8059 50.0001 25.0001 50.0001ZM31.5737 23.7947L31.451 23.6719L30.2512 22.4722L21.0045 13.2255C20.3126 12.5335 19.1742 12.5335 18.4766 13.2255C17.7847 13.9175 17.7847 15.0559 18.4766 15.7534L27.7289 25.0001L18.4822 34.2523C17.7902 34.9443 17.7902 36.0827 18.4822 36.7802C19.1742 37.4722 20.3126 37.4722 21.0045 36.7746L30.2512 27.528L31.4677 26.3114L31.5681 26.211C31.8639 25.8929 32.0425 25.4632 32.0369 24.9945C32.0369 24.5313 31.8639 24.1128 31.5737 23.7947Z" fill="#FF4F00"/>
                    </svg>
                </div>
                <div class="swiper-pagination"></div>
                <div class="custom-button-next custom-button">
                    <svg width="50" height="50" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect width="33.1429" height="27.7143" transform="matrix(-4.37114e-08 -1 -1 4.37114e-08 38.7145 40.7143)" fill="#FFFEFB"/>
                        <path d="M25.0614 24.9387L24.9387 25.0615C24.9777 25.0168 25.0168 24.9777 25.0614 24.9387Z" fill="white"/>
                        <path class="bg" d="M25.0001 50.0001C11.1942 50.0001 4.41472e-05 38.8059 4.41472e-05 25.0001C4.41472e-05 11.1942 11.1942 3.05176e-05 25.0001 3.05176e-05C38.8059 3.05176e-05 50.0001 11.1942 50.0001 25.0001C50.0001 38.8059 38.8059 50.0001 25.0001 50.0001ZM31.5737 23.7947L31.451 23.6719L30.2512 22.4722L21.0045 13.2255C20.3126 12.5335 19.1742 12.5335 18.4766 13.2255C17.7847 13.9175 17.7847 15.0559 18.4766 15.7534L27.7289 25.0001L18.4822 34.2523C17.7902 34.9443 17.7902 36.0827 18.4822 36.7802C19.1742 37.4722 20.3126 37.4722 21.0045 36.7746L30.2512 27.528L31.4677 26.3114L31.5681 26.211C31.8639 25.8929 32.0425 25.4632 32.0369 24.9945C32.0369 24.5313 31.8639 24.1128 31.5737 23.7947Z" fill="#FF4F00"/>
                    </svg>
                </div>
                
            </div>
        </div>
    </div>
</div>
<script>
; (function () {
    const oSection = document.querySelector('[data-section-id="{{ section.id }}"]');

    function initSwiper(){
        const mainSwiperEle = oSection.querySelector('.swiper');
        
        if(mainSwiperEle) {
            const mainSwiper = new Swiper(mainSwiperEle, {
                spaceBetween: 20,
                slidesPerView: 1,
                {% if section.settings.auto_loop %}
                    autoplay: {
                        delay: {{ section.settings.auto_loop_speed | times: 1000 }},
                        disableOnInteraction: false,
                    },
                {% endif %}
                pagination: {
                    el: oSection.querySelector('.swiper-pagination'),
                    clickable: true
                },
                navigation: {
                    nextEl: oSection.querySelector('.custom-button-next'),
                    prevEl: oSection.querySelector('.custom-button-prev'),
                }
            });
        }
    }
    
    window.addEventListener('DOMContentLoaded', function() {
        initSwiper();
    });

})();
</script>